using Microsoft.Win32;
using System.Diagnostics;
using System.Windows;

namespace WpfApp1
{

    /// <summary>
    /// App.xaml 的交互逻辑
    /// </summary>
    public partial class App : Application
    {
        private static System.Threading.Mutex mutex;
        protected override void OnStartup(StartupEventArgs e)
        {
            // 添加到 所有用户的 注册表启动项
            RegistryKey RKey = Registry.LocalMachine.CreateSubKey(@"SOFTWARE\Microsoft\Windows\CurrentVersion\Run");
            RKey.SetValue("AppName", "\"" + Process.GetCurrentProcess().MainModule.FileName + "\"");
            mutex = new System.Threading.Mutex(true, "OnlyRun_CRNS");
            if (mutex.WaitOne(0, false))
            {
                base.OnStartup(e);
            }
            else
            {
                _ = MessageBox.Show("该程序已经在运行！ 害怕！\nThe program is already running! Afraid!\nプログラムは既に実行中です！ 恐れ！", "Randroca");
                Process.GetCurrentProcess().Kill();
                Application.Current.Shutdown();
            }
        }
    }
}
/*
 * @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/....................................................................................................................................\@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^......................................................................................................................................=
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........................................................................................................................................
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........................................................................................................................................
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........................................................................................................................................
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........................................................................................................................................
@@@@@@@@@@@@@@@@@/[[[[[[[O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........]]]]]]]]]]]]]]]]]................................................................................]]]]]]`........................
@@@@@@@@@@@@@@@@@^       O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........@@@@@@@@@@@@@@@@@@@@@O]..........................................................................O@@@@@^........................
@@@@@@@@@@@@@@@@@^       O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........@@@@@@@@@@@@@@@@@@@@@@@@O`.......................................................................O@@@@@^........................
@@@@@@@@@@@@@@@@@^       O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........@@@@@@O[[[[[[[[[O@@@@@@@@@\......................................................................O@@@@@^........................
@@@@@@@@@@@@@@@@@^       O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........@@@@@@O............,O@@@@@@\.....................................................................O@@@@@^........................
@@@@@@@@@@@@@@@@@^       O@@@@@@@@@@@@O[`       [\@@@@@@@@@@@@/[[[[[[\@@@/[      [\@@@@@@@[[[[[[[[@@@@@@@@@@@/[[[[[[[O@@@@@@@O[`        ,[O@@@@@@@@@@[[[[[[[@@@/[      [\@@@@@@@@@........@@@@@@O..............O@@@@@@^.......]]]]]]`.........,]]]]]].......,]]]]]`....,]OO@O]]............O@@@@@^....,]O@OO]`............
@@@@@@@@@@@@@@@@@^       O@@@@@@@@@/                ,O@@@@@@@@^      =/             ,O@@@@\       =@@@@@@@@@O       =@@@@@O`                ,O@@@@@@@       /              \@@@@@@........@@@@@@O..............,@@@@@@O.......@@@@@@^.........=@@@@@@.......=@@@@@^.]O@@@@@@@@@@@\.........O@@@@@^.]O@@@@@@@@@@O`.........
@@@@@@@@@@@@@@@@@^       O@@@@@@@/                    ,O@@@@@@^                       \@@@@^       \@@@@@@@@`      ,@@@@@^                    \@@@@@@                       \@@@@@........@@@@@@O...............O@@@@@@^......@@@@@@^.........=@@@@@@.......=@@@@@O@@@@@@@@@@@@@@@O........O@@@@@@@@@@@@@@@@@@@@@^........
@@@@@@@@@@@@@@@@@^       O@@@@@@^        ]@@@@O`        \@@@@@^         ,O@@@\        =@@@@@`       @@@@@@@^       O@@@@^       /@@@@@\       =@@@@@@         ,/@@@O`        @@@@@........@@@@@@O...............=@@@@@@^......@@@@@@^.........=@@@@@@.......=@@@@@@@O[.....,O@@@@@@^.......O@@@@@@@/`.....\@@@@@@@........
@@@@@@@@@@@@@@@@@^       O@@@@@^       =@@@@@@@@@`       \@@@@^        O@@@@@@@        @@@@@@       =@@@@@@       =@@@@@O]]]   O@@@@@@@^       @@@@@@        /@@@@@@@`       @@@@@........@@@@@@O...............=@@@@@@^......@@@@@@^.........=@@@@@@.......=@@@@@@/........,@@@@@@\.......O@@@@@@^........=@@@@@@^.......
@@@@@@@@@@@@@@@@@^       O@@@@@       =@@@@@@@@@@@       ,@@@@^       =@@@@@@@@^       @@@@@@O       \@@@@`      =@@@@@@@@@@@@@@@@@@/[`        @@@@@@       =@@@@@@@@^       @@@@@........@@@@@@O...............=@@@@@@^......@@@@@@^.........=@@@@@@.......=@@@@@@^.........O@@@@@O.......O@@@@@O.........=@@@@@@^.......
@@@@@@@@@@@@@@@@@^       O@@@@^       =@@@@@@@@@@@^       @@@@^       =@@@@@@@@^       @@@@@@@^       @@@/       @@@@@@@@@@@[`                 @@@@@@       =@@@@@@@@^       @@@@@........@@@@@@O.............../@@@@@@^......@@@@@@^.........=@@@@@@.......=@@@@@@..........O@@@@@O.......O@@@@@/..........@@@@@@^.......
@@O[[[[[[@@@@@@@@^       O@@@@\       =@@@@@@@@@@@^       @@@@^       O@@@@@@@@^       @@@@@@@@^      ,@@       /@@@@@@@@`                    .@@@@@@       =@@@@@@@@^       @@@@@........@@@@@@O...............@@@@@@@.......@@@@@@^.........=@@@@@@.......=@@@@@@..........O@@@@@O.......O@@@@@^..........@@@@@@^.......
@O       \@@@@@@@^       @@@@@@       =@@@@@@@@@@@       ,@@@@^       O@@@@@@@@^       @@@@@@@@@       =^      =@@@@@@@@          ]]]O@^      .@@@@@@       =@@@@@@@@^       @@@@@........@@@@@@O............../@@@@@@^.......@@@@@@^........./@@@@@@.......=@@@@@@..........O@@@@@O.......O@@@@@^..........@@@@@@^.......
@@       ,@@@@@@O       .@@@@@@^       =@@@@@@@@@`       /@@@@^       O@@@@@@@@^       @@@@@@@@@O             ,@@@@@@@@^       O@@@@@@@^      .@@@@@@       =@@@@@@@@^       @@@@@........@@@@@@O............,O@@@@@@/........@@@@@@O........,O@@@@@@.......=@@@@@@..........O@@@@@O.......O@@@@@^..........@@@@@@^.......
@@^        [\@/`        /@@@@@@@`        [@@@@O`        /@@@@@^       O@@@@@@@@^       @@@@@@@@@@^            @@@@@@@@@^       ,O@@@@[         @@@@@@       =@@@@@@@@^       @@@@@........@@@@@@O]]]]]]]]]/O@@@@@@@@/.........O@@@@@@\....../@@@@@@@@.......=@@@@@@..........O@@@@@O.......O@@@@@^..........@@@@@@^.......
@@@^                   /@@@@@@@@@\                    ,O@@@@@@^       O@@@@@@@@^       @@@@@@@@@@@^          /@@@@@@@@@O                       @@@@@@       =@@@@@@@@^       @@@@@........@@@@@@@@@@@@@@@@@@@@@@@@O`..........,@@@@@@@@@@@@@@@OO@@@@@.......=@@@@@@..........O@@@@@O.......O@@@@@^..........@@@@@@^.......
@@@@O`               /@@@@@@@@@@@@@\                ,O@@@@@@@@^       O@@@@@@@@^       @@@@@@@@@@@@`        =@@@@@@@@@@@@`             /^      =@@@@@       =@@@@@@@@^       @@@@@........@@@@@@@@@@@@@@@@@@@@@O[...............\@@@@@@@@@@@O`.O@@@@@.......=@@@@@@..........O@@@@@O.......O@@@@@^..........@@@@@@^.......
@@@@@@@O]`       ]/@@@@@@@@@@@@@@@@@@@O]]       ]/@@@@@@@@@@@@\]]]]]]]O@@@@@@@@\]]]]]]]@@@@@@@@@@@@O       ,@@@@@@@@@@@@@@@\]      ,/@@@O]]]]]]]O@@@@]]]]]]]/@@@@@@@@\]]]]]]]@@@@@........[[[[[[[[[[[[[[[[[.......................,[\O@O/[.....[[[[[[.......,[[[[[[..........[[[[[[[.......[[[[[[`..........[[[[[[`.......
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`       O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........................................................................................................................................
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/        /@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........................................................................................................................................
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@O             =@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........................................................................................................................................
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           ,O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........................................................................................................................................
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^       ]/@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........................................................................................................................................
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^......................................................................................................................................=
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\..................................................................................................................................../@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
*/
